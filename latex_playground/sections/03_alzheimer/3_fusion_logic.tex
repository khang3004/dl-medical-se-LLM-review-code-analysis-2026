% -----------------------------------------------------------------------------
% Description: Logical OR Fusion (Static - Optimized Layout & Labels)
% -----------------------------------------------------------------------------

\begin{frame}{Dual-Model Fusion Strategy}
    \centering
    \vspace{-0.2cm}

    % --- PART 1: STRATEGIC GOAL & MATH ---
    \begin{columns}[t]
        \begin{column}{0.48\textwidth}
            \begin{alertblock}{The Problem}
                \centering
                High Precision vs. Low Sensitivity \\
                \footnotesize \textit{(Risk of False Negatives)}
            \end{alertblock}
        \end{column}
        \begin{column}{0.48\textwidth}
            \begin{block}{The Math: Logical Disjunction}
                \centering
                \Large $L_{final} = L_{1} \lor L_{2}$

                \vspace{0.2cm}
                \raggedright \scriptsize
                \textbf{Where:} \\
                $L_1$: Prediction of \textbf{Base VGG16}\\
                $L_2$: Prediction of \textbf{Tuned VGG16}
            \end{block}
        \end{column}
    \end{columns}

    \vspace{0.4cm}

    % --- PART 2: HORIZONTAL FUSION PIPELINE (Static) ---
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[
        node distance=0.5cm and 1.0cm,
        font=\sffamily\small,
        % Styles
        input/.style={
            rectangle, draw=black, thick, fill=gray!10,
            minimum width=1.5cm, minimum height=1.5cm, rounded corners=2pt
        },
        model/.style={
            rectangle, draw=DeepBlue, thick, fill=white,
            minimum width=2.5cm, minimum height=0.8cm, rounded corners=3pt,
            drop shadow
        },
        gate/.style={
            circle, draw=DeepBlue, ultra thick, fill=white,
            minimum size=1.2cm, inner sep=0pt
        },
        outcome/.style={
            rectangle, draw=black, thick,
            minimum width=2.2cm, minimum height=0.8cm, rounded corners=3pt,
            font=\bfseries
        },
        arrow/.style={->, >=stealth, ultra thick, DeepBlue, rounded corners=5pt}
    ]

        % 1. INPUT
        \node[input] (mri) {\includegraphics[width=1.2cm]{alzheimer/data_preprocessing/step6_roi}};
        \node[below=0.1cm of mri, font=\scriptsize] {Subject MRI};

        % 2. PARALLEL MODELS
        % Model 1 (Base)
        \node[model, above right=0.0cm and 1.5cm of mri] (m1) {\textbf{Base VGG16}};

        % Model 2 (Tuned)
        \node[model, below right=0.0cm and 1.5cm of mri] (m2) {\textbf{Tuned VGG16}};

        % 3. LOGIC GATE & TABLE
        \coordinate (midpoint) at ($(m1.east)!0.5!(m2.east)$);

        % Gate Position
        \node[gate, right=2.5cm of midpoint] (or) {\Huge $\lor$};

        % TRUTH TABLE (Moved ABOVE the gate to prevent bottom overflow)
        \node[above=0.3cm of or, draw=gray!50, rounded corners=2pt, fill=white, inner sep=3pt] (table) {
            \tiny
            \renewcommand{\arraystretch}{1.1}
            \setlength{\tabcolsep}{3pt}
            \begin{tabular}{cc|c}
                $L_1$ & $L_2$ & \textbf{Out} \\ \hline
                0 & 0 & \textcolor{green!60!black}{\textbf{0}} \\
                1 & 0 & \textcolor{red}{\textbf{1}} \\
                0 & 1 & \textcolor{red}{\textbf{1}} \\
                1 & 1 & \textcolor{red}{\textbf{1}} \\
            \end{tabular}
        };
        % Label linking table to gate
        \node[right=0.1cm of table, font=\tiny, text=gray, align=left] {Logic\\Rules};

        % 5. OUTPUTS
        \node[outcome, above right=0.2cm and 2.0cm of or, draw=red, fill=red!10, text=red] (ad) {AD (1)};
        \node[outcome, below right=0.2cm and 2.0cm of or, draw=green!60!black, fill=green!10, text=green!60!black] (cn) {CN (0)};

        % --- WIRING ---

        % Input -> Models
        \draw[arrow] (mri.east) -- ++(0.5,0) |- (m1.west);
        \draw[arrow] (mri.east) -- ++(0.5,0) |- (m2.west);

        % Models -> Gate (Labels Lifted)
        % L1 Label: Explicitly placed above the line with yshift
        \draw[arrow] (m1.east) -- node[midway, above, font=\bfseries\scriptsize, text=DeepBlue, yshift=3pt] {$L_1$} ++(0.8,0) |- (or.west);

        % L2 Label: Explicitly placed above the line with yshift
        \draw[arrow] (m2.east) -- node[midway, above, font=\bfseries\scriptsize, text=DeepBlue, yshift=3pt] {$L_2$} ++(0.8,0) |- (or.west);

        % Gate -> Output (Extended spacing for clear Yes/No)
        % True Logic
        \draw[arrow] (or.east) -- ++(0.8,0) |- node[pos=0.7, right, font=\scriptsize, text=red, xshift=2pt] {True} (ad.west);

        % False Logic
        \draw[arrow, dashed, gray] (or.east) -- ++(0.8,0) |- node[pos=0.7, right, font=\scriptsize, text=green!60!black, xshift=2pt] {False} (cn.west);

    \end{tikzpicture}
    }
\end{frame}